<!DOCTYPE html>
<html>
<head>
    <title>MCStoreHold Integration Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .success { color: green; padding: 10px; background: #f0fff0; border: 1px solid green; }
        .error { color: red; padding: 10px; background: #fff0f0; border: 1px solid red; }
        .product { border: 1px solid #ddd; padding: 15px; margin: 10px; border-radius: 5px; }
        .category { background: #f5f5f5; padding: 10px; margin: 5px 0; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üß™ MCStoreHold Frontend-Backend Integration Test</h1>
    
    <div id="status"></div>
    
    <div>
        <button onclick="testConnection()">Test Connection</button>
        <button onclick="loadProducts()">Load Products</button>
        <button onclick="testCategories()">Test Categories</button>
        <button onclick="testSingleProduct()">Test Single Product</button>
    </div>

    <div id="results"></div>

    <script src="./js/api/config.js"></script>
    <script src="./js/modules/productLoader.js"></script>
    <script>
        const statusDiv = document.getElementById('status');
        const resultsDiv = document.getElementById('results');

        async function testConnection() {
            statusDiv.innerHTML = 'Testing backend connection...';
            try {
                const response = await fetch('http://localhost:3001/api/health');
                const data = await response.json();
                
                if (data.success) {
                    statusDiv.innerHTML = `<div class="success">
                        ‚úÖ Backend Connected Successfully!<br>
                        üìä ${data.data.totalProducts} products available<br>
                        üóÑÔ∏è Database: ${data.data.database}<br>
                        üïí ${data.data.timestamp}
                    </div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">
                    ‚ùå Backend Connection Failed<br>
                    Error: ${error.message}<br>
                    üí° Make sure backend is running on port 3000
                </div>`;
            }
        }

        async function loadProducts() {
            resultsDiv.innerHTML = 'Loading products...';
            try {
                const products = await productLoader.loadProducts();
                
                resultsDiv.innerHTML = `
                    <h3>üì¶ Loaded ${products.length} Products:</h3>
                    <div class="category">
                        <strong>Categories:</strong> ${productLoader.getCategories().join(', ')}
                    </div>
                `;
                
                products.forEach(product => {
                    resultsDiv.innerHTML += `
                        <div class="product">
                            <strong>${product.name}</strong> - $${product.price}<br>
                            <small>${product.category} | Stock: ${product.stock}</small><br>
                            <em>${product.description}</em>
                        </div>
                    `;
                });
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">Failed to load products: ${error.message}</div>`;
            }
        }

        async function testCategories() {
            resultsDiv.innerHTML = 'Testing categories...';
            try {
                const categories = productLoader.getCategories();
                resultsDiv.innerHTML = `<h3>üè∑Ô∏è Categories:</h3>`;
                
                for (const category of categories) {
                    const products = productLoader.getProductsByCategory(category);
                    resultsDiv.innerHTML += `
                        <div class="category">
                            <strong>${category}</strong> (${products.length} products)
                        </div>
                    `;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">Failed to load categories: ${error.message}</div>`;
            }
        }

        async function testSingleProduct() {
            resultsDiv.innerHTML = 'Testing single product...';
            try {
                const product = await API_CONFIG.getProductById(1);
                resultsDiv.innerHTML = `
                    <h3>üîç Single Product Test (ID: 1):</h3>
                    <div class="product">
                        <strong>${product.name}</strong> - $${product.price}<br>
                        <small>${product.category} | Stock: ${product.stock}</small><br>
                        <em>${product.description}</em><br>
                        <strong>Features:</strong> ${product.features.join(', ')}
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">Failed to load single product: ${error.message}</div>`;
            }
        }

        // Auto-test on load
        document.addEventListener('DOMContentLoaded', testConnection);
    </script>
</body>
</html>
